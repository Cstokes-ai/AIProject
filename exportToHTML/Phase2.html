<div class="cell border-box-sizing code_cell rendered" id="cell-id=initial_id">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">keras</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=776ad9ff9b32c19">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#Load the dataset for phase 2</span>
<span class="c1">#first I need the path</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="s2">"C:</span><span class="se">\\</span><span class="s2">Users\corne\Downloads\loan_data.csv"</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_set</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>   person_age person_gender person_education  person_income  person_emp_exp  \
0        22.0        female           Master        71948.0               0   
1        21.0        female      High School        12282.0               0   
2        25.0        female      High School        12438.0               3   
3        23.0        female         Bachelor        79753.0               0   
4        24.0          male           Master        66135.0               1   

  person_home_ownership  loan_amnt loan_intent  loan_int_rate  \
0                  RENT    35000.0    PERSONAL          16.02   
1                   OWN     1000.0   EDUCATION          11.14   
2              MORTGAGE     5500.0     MEDICAL          12.87   
3                  RENT    35000.0     MEDICAL          15.23   
4                  RENT    35000.0     MEDICAL          14.27   

   loan_percent_income  cb_person_cred_hist_length  credit_score  \
0                 0.49                         3.0           561   
1                 0.08                         2.0           504   
2                 0.44                         3.0           635   
3                 0.44                         2.0           675   
4                 0.53                         4.0           586   

  previous_loan_defaults_on_file  loan_status  
0                             No            1  
1                            Yes            0  
2                             No            1  
3                             No            1  
4                             No            1  
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>&lt;&gt;:3: SyntaxWarning: invalid escape sequence '\c'
&lt;&gt;:3: SyntaxWarning: invalid escape sequence '\c'
C:\Users\corne\AppData\Local\Temp\ipykernel_13764\2224160038.py:3: SyntaxWarning: invalid escape sequence '\c'
  data_set = "C:\\Users\corne\Downloads\loan_data.csv"
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=d612f5c05eae9b63">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">keras</span>

<span class="c1"># --- Assume your DataFrame is already loaded as df ---</span>

<span class="c1"># Separate features and target</span>
<span class="n">X_raw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">]</span>

<span class="c1"># Define categorical and numerical columns</span>
<span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'person_gender'</span><span class="p">,</span> <span class="s1">'person_home_ownership'</span><span class="p">,</span> <span class="s1">'loan_intent'</span><span class="p">,</span>
                    <span class="s1">'previous_loan_defaults_on_file'</span><span class="p">,</span> <span class="s1">'person_education'</span><span class="p">]</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_raw</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical_cols</span><span class="p">]</span>

<span class="c1"># Preprocess: scale numerical and one-hot encode categorical</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">'num'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numerical_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">),</span> <span class="n">categorical_cols</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_raw</span><span class="p">)</span>

<span class="c1"># ----------- Overfitting model (no validation split) -----------</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Training overfitting model on the entire dataset (Phase 2)..."</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># batch_size=1 helps overfit</span>

<span class="c1"># Final evaluation on same data</span>
<span class="n">loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Final Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Final Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\layers\core\dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Training overfitting model on the entire dataset (Phase 2)...
Epoch 1/200
<span class="ansi-bold">45000/45000</span> <span class="ansi-green-fg">━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-bold">100s</span> 2ms/step - accuracy: 0.8975 - loss: 0.2271
Epoch 2/200
<span class="ansi-bold">45000/45000</span> <span class="ansi-green-fg">━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-bold">92s</span> 2ms/step - accuracy: 0.9184 - loss: 0.1873
Epoch 3/200
<span class="ansi-bold">17883/45000</span> <span class="ansi-green-fg">━━━━━━━</span><span class="ansi-white-fg">━━━━━━━━━━━━━</span> <span class="ansi-bold">50s</span> 2ms/step - accuracy: 0.9192 - loss: 0.1809</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[4]</span><span class="ansi-green-fg">, line 35</span>
<span class="ansi-green-fg">     32</span> model.compile(optimizer=<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">adam</span><span class="ansi-yellow-fg">'</span>, loss=<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">binary_crossentropy</span><span class="ansi-yellow-fg">'</span>, metrics=[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">accuracy</span><span class="ansi-yellow-fg">'</span>])
<span class="ansi-green-fg">     34</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Training overfitting model on the entire dataset (Phase 2)...</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">35</span> history = <span class="ansi-yellow-bg">model</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">epochs</span><span class="ansi-yellow-bg">=</span><span class="ansi-green-fg ansi-yellow-bg">200</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">batch_size</span><span class="ansi-yellow-bg">=</span><span class="ansi-green-fg ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>  <span style="color: rgb(95,135,135)"># batch_size=1 helps overfit</span>
<span class="ansi-green-fg">     37</span> <span style="color: rgb(95,135,135)"># Final evaluation on same data</span>
<span class="ansi-green-fg">     38</span> loss, accuracy = model.evaluate(X, y)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\utils\traceback_utils.py:117</span>, in <span class="ansi-cyan-fg">filter_traceback.&lt;locals&gt;.error_handler</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-fg">    115</span> filtered_tb = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">    119</span>     filtered_tb = _process_traceback_frames(e.__traceback__)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\backend\tensorflow\trainer.py:371</span>, in <span class="ansi-cyan-fg">TensorFlowTrainer.fit</span><span class="ansi-blue-fg">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq)</span>
<span class="ansi-green-fg">    369</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> step, iterator <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> epoch_iterator:
<span class="ansi-green-fg">    370</span>     callbacks.on_train_batch_begin(step)
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">371</span>     logs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">train_function</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    372</span>     callbacks.on_train_batch_end(step, logs)
<span class="ansi-green-fg">    373</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>.stop_training:

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\backend\tensorflow\trainer.py:219</span>, in <span class="ansi-cyan-fg">TensorFlowTrainer._make_function.&lt;locals&gt;.function</span><span class="ansi-blue-fg">(iterator)</span>
<span class="ansi-green-fg">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">function</span>(iterator):
<span class="ansi-green-fg">    216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(
<span class="ansi-green-fg">    217</span>         iterator, (tf.data.Iterator, tf.distribute.DistributedIterator)
<span class="ansi-green-fg">    218</span>     ):
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">219</span>         opt_outputs = <span class="ansi-yellow-bg">multi_step_on_iterator</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    220</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> opt_outputs.has_value():
<span class="ansi-green-fg">    221</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">StopIteration</span>

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\util\traceback_utils.py:150</span>, in <span class="ansi-cyan-fg">filter_traceback.&lt;locals&gt;.error_handler</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-fg">    148</span> filtered_tb = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">    149</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">150</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    151</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">    152</span>   filtered_tb = _process_traceback_frames(e.__traceback__)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py:833</span>, in <span class="ansi-cyan-fg">Function.__call__</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-fg">    830</span> compiler = <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">xla</span><span class="ansi-yellow-fg">"</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._jit_compile <span class="ansi-bold" style="color: rgb(0,135,0)">else</span> <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">nonXla</span><span class="ansi-yellow-fg">"</span>
<span class="ansi-green-fg">    832</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> OptionalXlaContext(<span style="color: rgb(0,135,0)">self</span>._jit_compile):
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">833</span>   result = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    835</span> new_tracing_count = <span style="color: rgb(0,135,0)">self</span>.experimental_get_tracing_count()
<span class="ansi-green-fg">    836</span> without_tracing = (tracing_count == new_tracing_count)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py:878</span>, in <span class="ansi-cyan-fg">Function._call</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-fg">    875</span> <span style="color: rgb(0,135,0)">self</span>._lock.release()
<span class="ansi-green-fg">    876</span> <span style="color: rgb(95,135,135)"># In this case we have not created variables on the first call. So we can</span>
<span class="ansi-green-fg">    877</span> <span style="color: rgb(95,135,135)"># run the first trace but we should fail if variables are created.</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">878</span> results = <span class="ansi-yellow-bg">tracing_compilation</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_function</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    879</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_variable_creation_config</span>
<span class="ansi-green-fg">    880</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    881</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._created_variables:
<span class="ansi-green-fg">    882</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Creating variables on a non-first call to a function</span><span class="ansi-yellow-fg">"</span>
<span class="ansi-green-fg">    883</span>                    <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg"> decorated with tf.function.</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py:139</span>, in <span class="ansi-cyan-fg">call_function</span><span class="ansi-blue-fg">(args, kwargs, tracing_options)</span>
<span class="ansi-green-fg">    137</span> bound_args = function.function_type.bind(*args, **kwargs)
<span class="ansi-green-fg">    138</span> flat_inputs = function.function_type.unpack_inputs(bound_args)
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">139</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_call_flat</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># pylint: disable=protected-access</span>
<span class="ansi-green-fg">    140</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">flat_inputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">captured_inputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">captured_inputs</span>
<span class="ansi-green-fg">    141</span> <span class="ansi-yellow-bg">)</span>

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\concrete_function.py:1322</span>, in <span class="ansi-cyan-fg">ConcreteFunction._call_flat</span><span class="ansi-blue-fg">(self, tensor_inputs, captured_inputs)</span>
<span class="ansi-green-fg">   1318</span> possible_gradient_type = gradients_util.PossibleTapeGradientTypes(args)
<span class="ansi-green-fg">   1319</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> (possible_gradient_type == gradients_util.POSSIBLE_GRADIENT_TYPES_NONE
<span class="ansi-green-fg">   1320</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> executing_eagerly):
<span class="ansi-green-fg">   1321</span>   <span style="color: rgb(95,135,135)"># No tape is watching; skip to running the function.</span>
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1322</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_inference_function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_preflattened</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1323</span> forward_backward = <span style="color: rgb(0,135,0)">self</span>._select_forward_and_backward_functions(
<span class="ansi-green-fg">   1324</span>     args,
<span class="ansi-green-fg">   1325</span>     possible_gradient_type,
<span class="ansi-green-fg">   1326</span>     executing_eagerly)
<span class="ansi-green-fg">   1327</span> forward_function, args_with_tangents = forward_backward.forward()

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py:216</span>, in <span class="ansi-cyan-fg">AtomicFunction.call_preflattened</span><span class="ansi-blue-fg">(self, args)</span>
<span class="ansi-green-fg">    214</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">call_preflattened</span>(<span style="color: rgb(0,135,0)">self</span>, args: Sequence[core.Tensor]) -&gt; Any:
<span class="ansi-green-fg">    215</span> <span style="color: rgb(188,188,188)">  </span><span class="ansi-yellow-fg">"""Calls with flattened tensor inputs and returns the structured output."""</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">216</span>   flat_outputs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_flat</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    217</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span>.function_type.pack_output(flat_outputs)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py:251</span>, in <span class="ansi-cyan-fg">AtomicFunction.call_flat</span><span class="ansi-blue-fg">(self, *args)</span>
<span class="ansi-green-fg">    249</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> record.stop_recording():
<span class="ansi-green-fg">    250</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._bound_context.executing_eagerly():
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">251</span>     outputs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_bound_context</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_function</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    252</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    253</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">list</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    254</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">len</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">function_type</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">flat_outputs</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    255</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    256</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    257</span>     outputs = make_call_op_in_graph(
<span class="ansi-green-fg">    258</span>         <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">    259</span>         <span style="color: rgb(0,135,0)">list</span>(args),
<span class="ansi-green-fg">    260</span>         <span style="color: rgb(0,135,0)">self</span>._bound_context.function_call_options.as_attrs(),
<span class="ansi-green-fg">    261</span>     )

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\context.py:1688</span>, in <span class="ansi-cyan-fg">Context.call_function</span><span class="ansi-blue-fg">(self, name, tensor_inputs, num_outputs)</span>
<span class="ansi-green-fg">   1686</span> cancellation_context = cancellation.context()
<span class="ansi-green-fg">   1687</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> cancellation_context <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1688</span>   outputs = <span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">   1689</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">decode</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">utf-8</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1690</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1691</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tensor_inputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1692</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1693</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1694</span> <span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1695</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">   1696</span>   outputs = execute.execute_with_cancellation(
<span class="ansi-green-fg">   1697</span>       name.decode(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">utf-8</span><span class="ansi-yellow-fg">"</span>),
<span class="ansi-green-fg">   1698</span>       num_outputs=num_outputs,
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">   1702</span>       cancellation_manager=cancellation_context,
<span class="ansi-green-fg">   1703</span>   )

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\execute.py:53</span>, in <span class="ansi-cyan-fg">quick_execute</span><span class="ansi-blue-fg">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="ansi-green-fg">     51</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">     52</span>   ctx.ensure_initialized()
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">53</span>   tensors = <span class="ansi-yellow-bg">pywrap_tfe</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">TFE_Py_Execute</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_handle</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">device_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">op_name</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">     54</span> <span class="ansi-yellow-bg">                                      </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     55</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> core._NotOkStatusException <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">     56</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> name <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=c7a36ca5">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">keras</span>

<span class="c1"># -------- Prepare data --------</span>
<span class="c1"># Target variable</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">]</span>

<span class="c1"># Feature matrix (keep all columns except loan_status)</span>
<span class="n">X_raw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">])</span>

<span class="c1"># Normalize numerical data</span>
<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_raw</span><span class="p">)</span>

<span class="c1"># Train-validation split (80-20)</span>
<span class="n">split_index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.8</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">split_index</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>
<span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="n">split_index</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">split_index</span><span class="p">:]</span>

<span class="c1"># -------- Build the model --------</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>

<span class="c1"># -------- Train the model --------</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">64</span><span class="p">,</span>        <span class="c1"># Use larger batch size to speed up training</span>
    <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span>             <span class="c1"># Show clear training progress</span>
<span class="p">)</span>

<span class="c1"># -------- Evaluate --------</span>
<span class="n">loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Final Validation Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Final Validation Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">~\AppData\Local\Temp\ipykernel_13764\1514645831.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">     10</span> X_raw = df.drop(columns=[<span class="ansi-yellow-fg">'loan_status'</span>])
<span class="ansi-green-fg">     11</span> 
<span class="ansi-green-fg">     12</span> <span style="color: rgb(95,135,135)"># Normalize numerical data</span>
<span class="ansi-green-fg">     13</span> scaler = StandardScaler()
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">14</span> X = scaler.fit_transform(X_raw)
<span class="ansi-green-fg">     15</span> 
<span class="ansi-green-fg">     16</span> <span style="color: rgb(95,135,135)"># Train-validation split (80-20)</span>
<span class="ansi-green-fg">     17</span> split_index = int(<span class="ansi-green-fg">0.8</span> * len(X))

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\utils\_set_output.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, X, *args, **kwargs)</span>
<span class="ansi-green-fg">    317</span>     @wraps(f)
<span class="ansi-green-fg">    318</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">def</span> wrapped(self, X, *args, **kwargs):
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">319</span>         data_to_wrap = f(self, X, *args, **kwargs)
<span class="ansi-green-fg">    320</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> isinstance(data_to_wrap, tuple):
<span class="ansi-green-fg">    321</span>             <span style="color: rgb(95,135,135)"># only wrap the first output for cross decomposition</span>
<span class="ansi-green-fg">    322</span>             return_tuple = (

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\base.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, X, y, **fit_params)</span>
<span class="ansi-green-fg">    914</span>                 )
<span class="ansi-green-fg">    915</span> 
<span class="ansi-green-fg">    916</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> y <span class="ansi-bold" style="color: rgb(0,135,0)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">    917</span>             <span style="color: rgb(95,135,135)"># fit method of arity 1 (unsupervised transformation)</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">918</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> self.fit(X, **fit_params).transform(X)
<span class="ansi-green-fg">    919</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    920</span>             <span style="color: rgb(95,135,135)"># fit method of arity 2 (supervised transformation)</span>
<span class="ansi-green-fg">    921</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> self.fit(X, y, **fit_params).transform(X)

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\preprocessing\_data.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, X, y, sample_weight)</span>
<span class="ansi-green-fg">    890</span>             Fitted scaler.
<span class="ansi-green-fg">    891</span>         """
<span class="ansi-green-fg">    892</span>         <span style="color: rgb(95,135,135)"># Reset internal state before fitting</span>
<span class="ansi-green-fg">    893</span>         self._reset()
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">894</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> self.partial_fit(X, y, sample_weight)

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\base.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(estimator, *args, **kwargs)</span>
<span class="ansi-green-fg">   1385</span>                 skip_parameter_validation=(
<span class="ansi-green-fg">   1386</span>                     prefer_skip_nested_validation <span class="ansi-bold" style="color: rgb(0,135,0)">or</span> global_skip_validation
<span class="ansi-green-fg">   1387</span>                 )
<span class="ansi-green-fg">   1388</span>             ):
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1389</span>                 <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> fit_method(estimator, *args, **kwargs)

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\preprocessing\_data.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, X, y, sample_weight)</span>
<span class="ansi-green-fg">    926</span>         self : object
<span class="ansi-green-fg">    927</span>             Fitted scaler.
<span class="ansi-green-fg">    928</span>         """
<span class="ansi-green-fg">    929</span>         first_call = <span class="ansi-bold" style="color: rgb(0,135,0)">not</span> hasattr(self, <span class="ansi-yellow-fg">"n_samples_seen_"</span>)
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">930</span>         X = validate_data(
<span class="ansi-green-fg">    931</span>             self,
<span class="ansi-green-fg">    932</span>             X,
<span class="ansi-green-fg">    933</span>             accept_sparse=(<span class="ansi-yellow-fg">"csr"</span>, <span class="ansi-yellow-fg">"csc"</span>),

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\utils\validation.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(_estimator, X, y, reset, validate_separately, skip_check_array, **check_params)</span>
<span class="ansi-green-fg">   2940</span>             out = y
<span class="ansi-green-fg">   2941</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">   2942</span>             out = X, y
<span class="ansi-green-fg">   2943</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> <span class="ansi-bold" style="color: rgb(0,135,0)">not</span> no_val_X <span class="ansi-bold" style="color: rgb(0,135,0)">and</span> no_val_y:
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">2944</span>         out = check_array(X, input_name=<span class="ansi-yellow-fg">"X"</span>, **check_params)
<span class="ansi-green-fg">   2945</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">elif</span> no_val_X <span class="ansi-bold" style="color: rgb(0,135,0)">and</span> <span class="ansi-bold" style="color: rgb(0,135,0)">not</span> no_val_y:
<span class="ansi-green-fg">   2946</span>         out = _check_y(y, **check_params)
<span class="ansi-green-fg">   2947</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\utils\validation.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(array, accept_sparse, accept_large_sparse, dtype, order, copy, force_writeable, force_all_finite, ensure_all_finite, ensure_non_negative, ensure_2d, allow_nd, ensure_min_samples, ensure_min_features, estimator, input_name)</span>
<span class="ansi-green-fg">   1052</span>                         )
<span class="ansi-green-fg">   1053</span>                     array = xp.astype(array, dtype, copy=<span class="ansi-bold" style="color: rgb(0,135,0)">False</span>)
<span class="ansi-green-fg">   1054</span>                 <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">   1055</span>                     array = _asarray_with_order(array, order=order, dtype=dtype, xp=xp)
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1056</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> ComplexWarning <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> complex_warning:
<span class="ansi-green-fg">   1057</span>                 raise ValueError(
<span class="ansi-green-fg">   1058</span>                     <span class="ansi-yellow-fg">"Complex data not supported\n{}\n"</span>.format(array)
<span class="ansi-green-fg">   1059</span>                 ) <span class="ansi-bold" style="color: rgb(0,135,0)">from</span> complex_warning

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\sklearn\utils\_array_api.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(array, dtype, order, copy, xp, device)</span>
<span class="ansi-green-fg">    835</span>         <span style="color: rgb(95,135,135)"># Use NumPy API to support order</span>
<span class="ansi-green-fg">    836</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> copy <span class="ansi-bold" style="color: rgb(0,135,0)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">True</span>:
<span class="ansi-green-fg">    837</span>             array = numpy.array(array, order=order, dtype=dtype)
<span class="ansi-green-fg">    838</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">839</span>             array = numpy.asarray(array, order=order, dtype=dtype)
<span class="ansi-green-fg">    840</span> 
<span class="ansi-green-fg">    841</span>         <span style="color: rgb(95,135,135)"># At this point array is a NumPy ndarray. We convert it to an array</span>
<span class="ansi-green-fg">    842</span>         <span style="color: rgb(95,135,135)"># container that is consistent with the input's namespace.</span>

<span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\pandas\core\generic.py</span> in <span class="ansi-cyan-fg">?</span><span class="ansi-blue-fg">(self, dtype, copy)</span>
<span class="ansi-green-fg">   2149</span>     def __array__(
<span class="ansi-green-fg">   2150</span>         self, dtype: npt.DTypeLike | <span class="ansi-bold" style="color: rgb(0,135,0)">None</span> = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>, copy: bool_t | <span class="ansi-bold" style="color: rgb(0,135,0)">None</span> = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">   2151</span>     ) -&gt; np.ndarray:
<span class="ansi-green-fg">   2152</span>         values = self._values
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">2153</span>         arr = np.asarray(values, dtype=dtype)
<span class="ansi-green-fg">   2154</span>         if (
<span class="ansi-green-fg">   2155</span>             astype_is_view(values.dtype, arr.dtype)
<span class="ansi-green-fg">   2156</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">and</span> using_copy_on_write()

<span class="ansi-red-fg">ValueError</span>: could not convert string to float: 'female'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" id="cell-id=9d8664a4">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.preprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">OneHotEncoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.compose</span><span class="w"> </span><span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="kn">import</span> <span class="n">keras</span>

<span class="c1"># --- Assume your DataFrame is already loaded as df ---</span>

<span class="c1"># Separate features and target</span>
<span class="n">X_raw</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'loan_status'</span><span class="p">]</span>

<span class="c1"># Define categorical and numerical columns</span>
<span class="n">categorical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'person_gender'</span><span class="p">,</span> <span class="s1">'person_home_ownership'</span><span class="p">,</span> <span class="s1">'loan_intent'</span><span class="p">,</span>
                    <span class="s1">'previous_loan_defaults_on_file'</span><span class="p">,</span> <span class="s1">'person_education'</span><span class="p">]</span>
<span class="n">numerical_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X_raw</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">categorical_cols</span><span class="p">]</span>

<span class="c1"># Preprocess: scale numerical and one-hot encode categorical</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">(</span><span class="n">transformers</span><span class="o">=</span><span class="p">[</span>
    <span class="p">(</span><span class="s1">'num'</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">numerical_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">'cat'</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">'ignore'</span><span class="p">),</span> <span class="n">categorical_cols</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_raw</span><span class="p">)</span>

<span class="c1"># ----------- Overfitting model (complex structure) -----------</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],)),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">)</span>
<span class="p">])</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adam'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">'accuracy'</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Training high-capacity model on the entire dataset (Phase 2)..."</span><span class="p">)</span>
<span class="n">history</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># batch_size=1 helps overfit</span>

<span class="c1"># Final evaluation on same data</span>
<span class="n">loss</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="se">\n</span><span class="s2">Final Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Final Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Training high-capacity model on the entire dataset (Phase 2)...
Epoch 1/200
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\layers\core\dense.py:87: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.
  super().__init__(activity_regularizer=activity_regularizer, **kwargs)
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">45000/45000</span> <span class="ansi-green-fg">━━━━━━━━━━━━━━━━━━━━</span> <span class="ansi-bold">111s</span> 2ms/step - accuracy: 0.8944 - loss: 0.2317
Epoch 2/200
<span class="ansi-bold">26028/45000</span> <span class="ansi-green-fg">━━━━━━━━━━━</span><span class="ansi-white-fg">━━━━━━━━━</span> <span class="ansi-bold">44s</span> 2ms/step - accuracy: 0.9160 - loss: 0.1901</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-cyan-fg">Cell</span><span class="ansi-cyan-fg"> </span><span class="ansi-green-fg">In[5]</span><span class="ansi-green-fg">, line 37</span>
<span class="ansi-green-fg">     34</span> model.compile(optimizer=<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">adam</span><span class="ansi-yellow-fg">'</span>, loss=<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">binary_crossentropy</span><span class="ansi-yellow-fg">'</span>, metrics=[<span class="ansi-yellow-fg">'</span><span class="ansi-yellow-fg">accuracy</span><span class="ansi-yellow-fg">'</span>])
<span class="ansi-green-fg">     36</span> <span style="color: rgb(0,135,0)">print</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Training high-capacity model on the entire dataset (Phase 2)...</span><span class="ansi-yellow-fg">"</span>)
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">37</span> history = <span class="ansi-yellow-bg">model</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">fit</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">X</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">y</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">epochs</span><span class="ansi-yellow-bg">=</span><span class="ansi-green-fg ansi-yellow-bg">200</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">batch_size</span><span class="ansi-yellow-bg">=</span><span class="ansi-green-fg ansi-yellow-bg">1</span><span class="ansi-yellow-bg">)</span>  <span style="color: rgb(95,135,135)"># batch_size=1 helps overfit</span>
<span class="ansi-green-fg">     39</span> <span style="color: rgb(95,135,135)"># Final evaluation on same data</span>
<span class="ansi-green-fg">     40</span> loss, accuracy = model.evaluate(X, y)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\utils\traceback_utils.py:117</span>, in <span class="ansi-cyan-fg">filter_traceback.&lt;locals&gt;.error_handler</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-fg">    115</span> filtered_tb = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">    116</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">117</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    118</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">    119</span>     filtered_tb = _process_traceback_frames(e.__traceback__)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\backend\tensorflow\trainer.py:371</span>, in <span class="ansi-cyan-fg">TensorFlowTrainer.fit</span><span class="ansi-blue-fg">(self, x, y, batch_size, epochs, verbose, callbacks, validation_split, validation_data, shuffle, class_weight, sample_weight, initial_epoch, steps_per_epoch, validation_steps, validation_batch_size, validation_freq)</span>
<span class="ansi-green-fg">    369</span> <span class="ansi-bold" style="color: rgb(0,135,0)">for</span> step, iterator <span class="ansi-bold" style="color: rgb(175,0,255)">in</span> epoch_iterator:
<span class="ansi-green-fg">    370</span>     callbacks.on_train_batch_begin(step)
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">371</span>     logs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">train_function</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    372</span>     callbacks.on_train_batch_end(step, logs)
<span class="ansi-green-fg">    373</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>.stop_training:

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\keras\src\backend\tensorflow\trainer.py:219</span>, in <span class="ansi-cyan-fg">TensorFlowTrainer._make_function.&lt;locals&gt;.function</span><span class="ansi-blue-fg">(iterator)</span>
<span class="ansi-green-fg">    215</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">function</span>(iterator):
<span class="ansi-green-fg">    216</span>     <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">isinstance</span>(
<span class="ansi-green-fg">    217</span>         iterator, (tf.data.Iterator, tf.distribute.DistributedIterator)
<span class="ansi-green-fg">    218</span>     ):
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">219</span>         opt_outputs = <span class="ansi-yellow-bg">multi_step_on_iterator</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">iterator</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    220</span>         <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> opt_outputs.has_value():
<span class="ansi-green-fg">    221</span>             <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">StopIteration</span>

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\util\traceback_utils.py:150</span>, in <span class="ansi-cyan-fg">filter_traceback.&lt;locals&gt;.error_handler</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-fg">    148</span> filtered_tb = <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>
<span class="ansi-green-fg">    149</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">150</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">fn</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwargs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    151</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> <span class="ansi-bold" style="color: rgb(215,95,95)">Exception</span> <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">    152</span>   filtered_tb = _process_traceback_frames(e.__traceback__)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py:833</span>, in <span class="ansi-cyan-fg">Function.__call__</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-fg">    830</span> compiler = <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">xla</span><span class="ansi-yellow-fg">"</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._jit_compile <span class="ansi-bold" style="color: rgb(0,135,0)">else</span> <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">nonXla</span><span class="ansi-yellow-fg">"</span>
<span class="ansi-green-fg">    832</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> OptionalXlaContext(<span style="color: rgb(0,135,0)">self</span>._jit_compile):
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">833</span>   result = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_call</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    835</span> new_tracing_count = <span style="color: rgb(0,135,0)">self</span>.experimental_get_tracing_count()
<span class="ansi-green-fg">    836</span> without_tracing = (tracing_count == new_tracing_count)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\polymorphic_function.py:878</span>, in <span class="ansi-cyan-fg">Function._call</span><span class="ansi-blue-fg">(self, *args, **kwds)</span>
<span class="ansi-green-fg">    875</span> <span style="color: rgb(0,135,0)">self</span>._lock.release()
<span class="ansi-green-fg">    876</span> <span style="color: rgb(95,135,135)"># In this case we have not created variables on the first call. So we can</span>
<span class="ansi-green-fg">    877</span> <span style="color: rgb(95,135,135)"># run the first trace but we should fail if variables are created.</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">878</span> results = <span class="ansi-yellow-bg">tracing_compilation</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_function</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    879</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">kwds</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_variable_creation_config</span>
<span class="ansi-green-fg">    880</span> <span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    881</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._created_variables:
<span class="ansi-green-fg">    882</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">raise</span> <span class="ansi-bold" style="color: rgb(215,95,95)">ValueError</span>(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">Creating variables on a non-first call to a function</span><span class="ansi-yellow-fg">"</span>
<span class="ansi-green-fg">    883</span>                    <span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg"> decorated with tf.function.</span><span class="ansi-yellow-fg">"</span>)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\tracing_compilation.py:139</span>, in <span class="ansi-cyan-fg">call_function</span><span class="ansi-blue-fg">(args, kwargs, tracing_options)</span>
<span class="ansi-green-fg">    137</span> bound_args = function.function_type.bind(*args, **kwargs)
<span class="ansi-green-fg">    138</span> flat_inputs = function.function_type.unpack_inputs(bound_args)
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">139</span> <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg">function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_call_flat</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg" style="color: rgb(95,135,135)"># pylint: disable=protected-access</span>
<span class="ansi-green-fg">    140</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">flat_inputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">captured_inputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">captured_inputs</span>
<span class="ansi-green-fg">    141</span> <span class="ansi-yellow-bg">)</span>

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\concrete_function.py:1322</span>, in <span class="ansi-cyan-fg">ConcreteFunction._call_flat</span><span class="ansi-blue-fg">(self, tensor_inputs, captured_inputs)</span>
<span class="ansi-green-fg">   1318</span> possible_gradient_type = gradients_util.PossibleTapeGradientTypes(args)
<span class="ansi-green-fg">   1319</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> (possible_gradient_type == gradients_util.POSSIBLE_GRADIENT_TYPES_NONE
<span class="ansi-green-fg">   1320</span>     <span class="ansi-bold" style="color: rgb(175,0,255)">and</span> executing_eagerly):
<span class="ansi-green-fg">   1321</span>   <span style="color: rgb(95,135,135)"># No tape is watching; skip to running the function.</span>
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1322</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_inference_function</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_preflattened</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1323</span> forward_backward = <span style="color: rgb(0,135,0)">self</span>._select_forward_and_backward_functions(
<span class="ansi-green-fg">   1324</span>     args,
<span class="ansi-green-fg">   1325</span>     possible_gradient_type,
<span class="ansi-green-fg">   1326</span>     executing_eagerly)
<span class="ansi-green-fg">   1327</span> forward_function, args_with_tangents = forward_backward.forward()

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py:216</span>, in <span class="ansi-cyan-fg">AtomicFunction.call_preflattened</span><span class="ansi-blue-fg">(self, args)</span>
<span class="ansi-green-fg">    214</span> <span class="ansi-bold" style="color: rgb(0,135,0)">def</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-blue-fg">call_preflattened</span>(<span style="color: rgb(0,135,0)">self</span>, args: Sequence[core.Tensor]) -&gt; Any:
<span class="ansi-green-fg">    215</span> <span style="color: rgb(188,188,188)">  </span><span class="ansi-yellow-fg">"""Calls with flattened tensor inputs and returns the structured output."""</span>
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">216</span>   flat_outputs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_flat</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">*</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    217</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">return</span> <span style="color: rgb(0,135,0)">self</span>.function_type.pack_output(flat_outputs)

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\polymorphic_function\atomic_function.py:251</span>, in <span class="ansi-cyan-fg">AtomicFunction.call_flat</span><span class="ansi-blue-fg">(self, *args)</span>
<span class="ansi-green-fg">    249</span> <span class="ansi-bold" style="color: rgb(0,135,0)">with</span> record.stop_recording():
<span class="ansi-green-fg">    250</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> <span style="color: rgb(0,135,0)">self</span>._bound_context.executing_eagerly():
<span class="ansi-green-fg">--&gt; </span><span class="ansi-green-fg">251</span>     outputs = <span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_bound_context</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">call_function</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">    252</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    253</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">list</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">args</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    254</span> <span class="ansi-yellow-bg">        </span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">len</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">function_type</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">flat_outputs</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">    255</span> <span class="ansi-yellow-bg">    </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">    256</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">    257</span>     outputs = make_call_op_in_graph(
<span class="ansi-green-fg">    258</span>         <span style="color: rgb(0,135,0)">self</span>,
<span class="ansi-green-fg">    259</span>         <span style="color: rgb(0,135,0)">list</span>(args),
<span class="ansi-green-fg">    260</span>         <span style="color: rgb(0,135,0)">self</span>._bound_context.function_call_options.as_attrs(),
<span class="ansi-green-fg">    261</span>     )

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\context.py:1688</span>, in <span class="ansi-cyan-fg">Context.call_function</span><span class="ansi-blue-fg">(self, name, tensor_inputs, num_outputs)</span>
<span class="ansi-green-fg">   1686</span> cancellation_context = cancellation.context()
<span class="ansi-green-fg">   1687</span> <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> cancellation_context <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:
<span class="ansi-green-fg">-&gt; </span><span class="ansi-green-fg">1688</span>   outputs = <span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">execute</span><span class="ansi-yellow-bg">(</span>
<span class="ansi-green-fg">   1689</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">name</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">decode</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-fg ansi-yellow-bg">utf-8</span><span class="ansi-yellow-fg ansi-yellow-bg">"</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1690</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1691</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">tensor_inputs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1692</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1693</span> <span class="ansi-yellow-bg">      </span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">=</span><span class="ansi-yellow-bg" style="color: rgb(0,135,0)">self</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">   1694</span> <span class="ansi-yellow-bg">  </span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">   1695</span> <span class="ansi-bold" style="color: rgb(0,135,0)">else</span>:
<span class="ansi-green-fg">   1696</span>   outputs = execute.execute_with_cancellation(
<span class="ansi-green-fg">   1697</span>       name.decode(<span class="ansi-yellow-fg">"</span><span class="ansi-yellow-fg">utf-8</span><span class="ansi-yellow-fg">"</span>),
<span class="ansi-green-fg">   1698</span>       num_outputs=num_outputs,
<span class="ansi-green-fg">   (...)</span><span class="ansi-green-fg">   1702</span>       cancellation_manager=cancellation_context,
<span class="ansi-green-fg">   1703</span>   )

<span class="ansi-cyan-fg">File </span><span class="ansi-green-fg">c:\Users\corne\Downloads\AIProject\.venv\Lib\site-packages\tensorflow\python\eager\execute.py:53</span>, in <span class="ansi-cyan-fg">quick_execute</span><span class="ansi-blue-fg">(op_name, num_outputs, inputs, attrs, ctx, name)</span>
<span class="ansi-green-fg">     51</span> <span class="ansi-bold" style="color: rgb(0,135,0)">try</span>:
<span class="ansi-green-fg">     52</span>   ctx.ensure_initialized()
<span class="ansi-green-fg">---&gt; </span><span class="ansi-green-fg">53</span>   tensors = <span class="ansi-yellow-bg">pywrap_tfe</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">TFE_Py_Execute</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">ctx</span><span class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">_handle</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">device_name</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">op_name</span><span class="ansi-yellow-bg">,</span>
<span class="ansi-green-fg">     54</span> <span class="ansi-yellow-bg">                                      </span><span class="ansi-yellow-bg">inputs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">attrs</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">num_outputs</span><span class="ansi-yellow-bg">)</span>
<span class="ansi-green-fg">     55</span> <span class="ansi-bold" style="color: rgb(0,135,0)">except</span> core._NotOkStatusException <span class="ansi-bold" style="color: rgb(0,135,0)">as</span> e:
<span class="ansi-green-fg">     56</span>   <span class="ansi-bold" style="color: rgb(0,135,0)">if</span> name <span class="ansi-bold" style="color: rgb(175,0,255)">is</span> <span class="ansi-bold" style="color: rgb(175,0,255)">not</span> <span class="ansi-bold" style="color: rgb(0,135,0)">None</span>:

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-intense-fg ansi-bold">The Kernel crashed while executing code in the current cell or a previous cell. 
</span>
<span class="ansi-red-intense-fg ansi-bold">Please review the code in the cell(s) to identify a possible cause of the failure. 
</span>
<span class="ansi-red-intense-fg ansi-bold">Click &lt;a href='https://aka.ms/vscodeJupyterKernelCrash'&gt;here&lt;/a&gt; for more info. 
</span>
<span class="ansi-red-intense-fg ansi-bold">View Jupyter &lt;a href='command:jupyter.viewOutput'&gt;log&lt;/a&gt; for further details.</span></pre>
</div>
</div>
</div>
</div>
</div>
